import{c as B}from"./chunk-KPYUGE5J.js";import{g as I}from"./chunk-LHV7NZRZ.js";import{a as R,b as F}from"./chunk-4KPI3YCU.js";import{g as z,h as L}from"./chunk-4UGXQIUE.js";import{l as D,m as q,t as V}from"./chunk-TKQ2UNUU.js";import"./chunk-TW4MKDRA.js";import"./chunk-3YGUWUUY.js";import{a as E,b as A}from"./chunk-NMIQV5RM.js";import{Cd as w,Eb as c,Fb as d,Ia as r,Ib as x,Jb as P,Kb as O,Mb as S,Rd as T,Sa as h,Sd as N,T as _,Ya as m,Z as k,_ as M,db as l,m as C,mb as a,nb as i,rc as y,sb as b,ub as f,vb as g,vc as v,y as u}from"./chunk-NQGTOHWB.js";var W=()=>[10,25,50];function j(o,t){o&1&&(a(0,"small",11),c(1,"Loading camps..."),i())}function G(o,t){if(o&1&&(a(0,"small",12),c(1),i()),o&2){let e=g();r(),d(e.errorMessage)}}function H(o,t){o&1&&(a(0,"tr")(1,"th"),c(2,"Medicine Name"),i(),a(3,"th"),c(4,"Medicine Type"),i(),a(5,"th"),c(6,"Quantity"),i()())}function J(o,t){if(o&1&&(a(0,"tr")(1,"td"),c(2),i(),a(3,"td"),c(4),i(),a(5,"td")(6,"span",20),c(7),i()()()),o&2){let e=t.$implicit;r(2),d(e.medicine_name),r(2),d(e.medicine_type),r(3),d(e.quantity)}}function K(o,t){o&1&&(a(0,"tr")(1,"td",21),c(2,"No stock found for selected camp."),i()())}function Q(o,t){if(o&1){let e=b();a(0,"div",13)(1,"div",14)(2,"p-button",15),f("onClick",function(){k(e);let s=g();return M(s.navigateToAddStock())}),i()(),a(3,"p-table",16),m(4,H,7,0,"ng-template",17)(5,J,8,3,"ng-template",18)(6,K,3,0,"ng-template",19),i()()}if(o&2){let e=g();r(2),l("outlined",!0),r(),l("value",e.filteredStockItems)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",S(6,W))}}function $(o,t){o&1&&(a(0,"div",22)(1,"p"),c(2,"Please select a camp from the dropdown to view its stock report."),i()())}function X(o,t){o&1&&(a(0,"div",22)(1,"p"),c(2,"No stock available for the selected camp."),i()())}var U=class o{campsService=_(B);router=_(I);camps=[];campOptions=[];selectedCampId=null;stockItems=[];filteredStockItems=[];loading=!1;errorMessage="";ngOnInit(){this.loadCamps()}loadCamps(){this.loading=!0,this.errorMessage="",this.campsService.getActiveCamps().pipe(u(t=>(console.error("Error loading camps:",t),this.errorMessage="Failed to load camps. Please try again later.",this.loading=!1,C([])))).subscribe({next:t=>{this.camps=t,this.camps.length>0?(this.campOptions=this.camps.filter(e=>e.campId!==void 0).map(e=>({label:e.campCode?`${e.campCode} - ${e.campName}`:e.campName,value:e.campId})),this.loading=!1,this.loadSampleStockData()):(this.campOptions=[{label:"HC001 - JANA VIGNANA VEDIKA TIRUVURU",value:1},{label:"BDC002 - JANA VIGNANA VEDIKA BAPATLA",value:2}],this.loadSampleStockData(),this.errorMessage="No camps found. Please try again later.",this.loading=!1),console.log("campOptions--->",this.campOptions)},error:t=>{console.error("Error in camps subscription:",t),this.loading=!1}})}loadStockDataFromCamps(t){this.stockItems=[],t.forEach(e=>{e.medicineStocks&&e.medicineStocks.length>0&&e.medicineStocks.forEach(n=>{let s=`Medicine (HSN: ${n.hsnCode})`;this.stockItems.push({campId:e.campId,medicine_name:s,medicine_type:"N/A",quantity:n.quantity,batch_no:n.batchNumber,exp_date:n.expiryDate?new Date(n.expiryDate):void 0})})})}loadStockData(){}loadSampleStockData(){this.stockItems=[]}onCampChange(){this.selectedCampId?(this.loading=!0,this.errorMessage="",this.campsService.getCampMedicineStockSummary(this.selectedCampId).pipe(u(t=>(console.error("Error loading camp medicine stock summary:",t),this.errorMessage="Failed to load stock summary. Please try again later.",this.loading=!1,this.filteredStockItems=[],C([])))).subscribe({next:t=>{console.log("summary--->",t),this.filteredStockItems=t.map(e=>{let n=e.medicineStocks&&e.medicineStocks.length>0?e.medicineStocks[0]:e.medicineLookupNew?.medicineStocks&&e.medicineLookupNew.medicineStocks.length>0?e.medicineLookupNew.medicineStocks[0]:null;return{campId:this.selectedCampId,medicine_name:e.medicineLookupNew?.medicationName||"N/A",medicine_type:e.medicineLookupNew?.medicineType||"N/A",quantity:e.quantity,batch_no:n?.batchNumber,exp_date:n?.expiryDate?new Date(n.expiryDate):void 0}}),this.loading=!1},error:t=>{console.error("Error in camp medicine stock summary subscription:",t),this.loading=!1,this.filteredStockItems=[]}})):this.filteredStockItems=[]}clearSelection(){this.selectedCampId=null,this.filteredStockItems=[]}getTotalQuantity(){return this.filteredStockItems.reduce((t,e)=>t+e.quantity,0)}navigateToAddStock(){this.router.navigate(["/stock/add"])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=h({type:o,selectors:[["app-current-stock"]],decls:13,vars:10,consts:[[1,"current-stock-container"],["header","Stock Report"],[1,"stock-container"],[1,"selection-section"],[1,"field"],["for","camp"],["id","camp","optionLabel","label","optionValue","value","placeholder","Select Camp to View Stock Report",1,"w-full",3,"ngModelChange","onChange","onClear","ngModel","options","showClear","disabled","appendTo"],["class","loading-text",4,"ngIf"],["class","error-text",4,"ngIf"],["class","table-section",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"loading-text"],[1,"error-text"],[1,"table-section"],[1,"table-header"],["label","Add Stock","icon","pi pi-plus",3,"onClick","outlined"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"quantity-badge"],["colspan","5",2,"text-align","center","padding","20px"],[1,"empty-state"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"p-card",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),c(6,"Select Camp"),i(),a(7,"p-dropdown",6),O("ngModelChange",function(p){return P(n.selectedCampId,p)||(n.selectedCampId=p),p}),f("onChange",function(){return n.onCampChange()})("onClear",function(){return n.clearSelection()}),i(),m(8,j,2,0,"small",7)(9,G,2,1,"small",8),i()(),m(10,Q,7,7,"div",9)(11,$,3,0,"div",10)(12,X,3,0,"div",10),i()()()),e&2&&(r(7),x("ngModel",n.selectedCampId),l("options",n.campOptions)("showClear",!0)("disabled",n.loading)("appendTo","body"),r(),l("ngIf",n.loading),r(),l("ngIf",n.errorMessage),r(),l("ngIf",n.selectedCampId&&n.filteredStockItems.length>0),r(),l("ngIf",!n.selectedCampId),r(),l("ngIf",n.selectedCampId&&n.filteredStockItems.length===0))},dependencies:[v,y,V,D,q,A,E,w,N,T,F,R,L,z],styles:[".current-stock-container[_ngcontent-%COMP%]{padding:0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px;padding:20px 0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;max-width:400px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:var(--medical-text);font-size:14px;margin-bottom:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{color:var(--medical-primary);font-size:12px;font-style:italic;margin-top:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{color:var(--medical-danger);font-size:12px;margin-top:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]     .p-dropdown{width:100%}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;padding-bottom:15px;border-bottom:2px solid var(--medical-border)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:var(--medical-text);margin:0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px 16px;background:linear-gradient(135deg,#2c5aa01a,#2c5aa00d);border-radius:8px;border:1px solid var(--medical-primary)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:var(--medical-text);font-size:14px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:700;color:var(--medical-primary);font-size:18px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-thead>tr>th{background:linear-gradient(135deg,#f8f9fa,#e9ecef);color:var(--medical-text);font-weight:600;padding:12px;border-bottom:2px solid var(--medical-border);text-transform:uppercase;font-size:12px;letter-spacing:.5px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:12px;border-bottom:1px solid var(--medical-border)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .quantity-badge{display:inline-block;padding:4px 12px;background:linear-gradient(135deg,#2c5aa01a,#2c5aa00d);color:var(--medical-primary);border-radius:6px;font-weight:600;font-size:14px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:#f8f9fa}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:40px;text-align:center;background-color:#f8f9fa;border-radius:8px;color:var(--medical-text-light);margin-top:15px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}"]})};export{U as CurrentStockComponent};
