import{a as w}from"./chunk-4WXE7PZR.js";import{a as $,b as z}from"./chunk-E4SL4NQR.js";import{g as F,h as U}from"./chunk-Z364KTRN.js";import{l as R,m as H,q as V}from"./chunk-DFYNJMLI.js";import"./chunk-TW4MKDRA.js";import"./chunk-3YGUWUUY.js";import{a as B,b as q}from"./chunk-NMIQV5RM.js";import{Cd as N,Eb as r,Fb as p,Ia as c,Ib as k,Jb as S,Kb as O,Mb as y,N as x,Sa as P,Sd as D,T as C,Vb as I,Xb as v,Ya as _,db as l,m as b,mb as a,nb as o,rc as E,ub as h,uc as A,vb as f,vc as T,y as s}from"./chunk-NQGTOHWB.js";var d={BASE_URL:"http://localhost:8080",API_PREFIX:"/api",ENDPOINTS:{CAMPS:{BASE:"/camps",ACTIVE:"/camps/active",BY_ID:t=>`/camps/${t}`,CREATE:"/camps",UPDATE:t=>`/camps/${t}`,DELETE:t=>`/camps/${t}`},STOCK:{BASE:"/stock",CURRENT:"/stock/current",ADD:"/stock",BY_CAMP:t=>`/stock/camp/${t}`},MEDICINES:{BASE:"/medicines",ACTIVE:"/medicines/active"},SUPPLIERS:{BASE:"/suppliers",ACTIVE:"/suppliers/active"}}};function M(t){return`${d.BASE_URL}${d.API_PREFIX}${t}`}var u=class t{http=C(w);getActiveCamps(){let n=M(d.ENDPOINTS.CAMPS.ACTIVE);return this.http.get(n).pipe(s(e=>{throw console.error("Error fetching active camps:",e),e}))}getCampById(n){let e=M(d.ENDPOINTS.CAMPS.BY_ID(n));return this.http.get(e).pipe(s(i=>{throw console.error(`Error fetching camp ${n}:`,i),i}))}static \u0275fac=function(e){return new(e||t)};static \u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})};var G=()=>[10,25,50];function Q(t,n){t&1&&(a(0,"small",11),r(1,"Loading camps..."),o())}function Y(t,n){if(t&1&&(a(0,"small",12),r(1),o()),t&2){let e=f();c(),p(e.errorMessage)}}function K(t,n){t&1&&(a(0,"tr")(1,"th"),r(2,"Medicine Name"),o(),a(3,"th"),r(4,"Medicine Type"),o(),a(5,"th"),r(6,"Quantity"),o(),a(7,"th"),r(8,"Batch No"),o(),a(9,"th"),r(10,"Expiry Date"),o()())}function W(t,n){if(t&1&&(a(0,"tr")(1,"td"),r(2),o(),a(3,"td"),r(4),o(),a(5,"td")(6,"span",22),r(7),o()(),a(8,"td"),r(9),o(),a(10,"td"),r(11),I(12,"date"),o()()),t&2){let e=n.$implicit;c(2),p(e.medicine_name),c(2),p(e.medicine_type),c(3),p(e.quantity),c(2),p(e.batch_no||"N/A"),c(2),p(e.exp_date?v(12,5,e.exp_date,"yyyy-MM-dd"):"N/A")}}function J(t,n){t&1&&(a(0,"tr")(1,"td",23),r(2,"No stock found for selected camp."),o()())}function X(t,n){if(t&1&&(a(0,"div",13)(1,"div",14)(2,"h3"),r(3,"Stock Report Details"),o(),a(4,"div",15)(5,"span",16),r(6,"Total Quantity:"),o(),a(7,"span",17),r(8),o()()(),a(9,"p-table",18),_(10,K,11,0,"ng-template",19)(11,W,13,8,"ng-template",20)(12,J,3,0,"ng-template",21),o()()),t&2){let e=f();c(8),p(e.getTotalQuantity()),c(),l("value",e.filteredStockItems)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",y(6,G))}}function Z(t,n){t&1&&(a(0,"div",24)(1,"p"),r(2,"Please select a camp from the dropdown to view its stock report."),o()())}function ee(t,n){t&1&&(a(0,"div",24)(1,"p"),r(2,"No stock available for the selected camp."),o()())}var L=class t{campsService=C(u);camps=[];campOptions=[];selectedCampId=null;stockItems=[];filteredStockItems=[];loading=!1;errorMessage="";ngOnInit(){this.loadCamps()}loadCamps(){this.loading=!0,this.errorMessage="",this.campsService.getActiveCamps().pipe(s(n=>(console.error("Error loading camps:",n),this.errorMessage="Failed to load camps. Please try again later.",this.loading=!1,b([])))).subscribe({next:n=>{this.camps=n,this.camps.length>0?(this.campOptions=this.camps.filter(e=>e.campId!==void 0).map(e=>({label:e.campCode?`${e.campCode} - ${e.campName}`:e.campName,value:e.campId})),this.loading=!1,this.loadSampleStockData()):(this.campOptions=[{label:"HC001 - JANA VIGNANA VEDIKA TIRUVURU",value:1},{label:"BDC002 - JANA VIGNANA VEDIKA BAPATLA",value:2}],this.loadSampleStockData(),this.errorMessage="No camps found. Please try again later.",this.loading=!1),console.log("campOptions--->",this.campOptions)},error:n=>{console.error("Error in camps subscription:",n),this.loading=!1}})}loadStockDataFromCamps(n){this.stockItems=[],n.forEach(e=>{e.medicineStocks&&e.medicineStocks.length>0&&e.medicineStocks.forEach(i=>{let m=`Medicine (HSN: ${i.hsnCode})`;this.stockItems.push({campId:e.campId,medicine_name:m,medicine_type:"N/A",quantity:i.quantity,batch_no:i.batchNumber,exp_date:i.expiryDate?new Date(i.expiryDate):void 0})})})}loadStockData(){}loadSampleStockData(){this.stockItems=[{campId:1,medicine_name:"Medicine (HSN: 300450)",medicine_type:"Tablet",quantity:100,batch_no:"BATCH001",exp_date:new Date("2027-12-01")},{campId:1,medicine_name:"Medicine (HSN: 300451)",medicine_type:"Capsule",quantity:400,batch_no:"BATCH002",exp_date:new Date("2027-12-01")},{campId:2,medicine_name:"Medicine (HSN: 300452)",medicine_type:"Syrup",quantity:250,batch_no:"BATCH003",exp_date:new Date("2026-06-30")},{campId:2,medicine_name:"Medicine (HSN: 300453)",medicine_type:"Tablet",quantity:500,batch_no:"BATCH004",exp_date:new Date("2026-08-15")},{campId:2,medicine_name:"Medicine (HSN: 300454)",medicine_type:"Injection",quantity:150,batch_no:"BATCH005",exp_date:new Date("2026-09-20")}]}onCampChange(){this.selectedCampId?this.filteredStockItems=this.stockItems.filter(n=>n.campId===this.selectedCampId):this.filteredStockItems=[]}clearSelection(){this.selectedCampId=null,this.filteredStockItems=[]}getTotalQuantity(){return this.filteredStockItems.reduce((n,e)=>n+e.quantity,0)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=P({type:t,selectors:[["app-current-stock"]],decls:13,vars:10,consts:[[1,"current-stock-container"],["header","Stock Report"],[1,"stock-container"],[1,"selection-section"],[1,"field"],["for","camp"],["id","camp","optionLabel","label","optionValue","value","placeholder","Select Camp to View Stock Report",1,"w-full",3,"ngModelChange","onChange","onClear","ngModel","options","showClear","disabled","appendTo"],["class","loading-text",4,"ngIf"],["class","error-text",4,"ngIf"],["class","table-section",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"loading-text"],[1,"error-text"],[1,"table-section"],[1,"table-header"],[1,"total-quantity"],[1,"label"],[1,"value"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"quantity-badge"],["colspan","5",2,"text-align","center","padding","20px"],[1,"empty-state"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"p-card",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),r(6,"Select Camp"),o(),a(7,"p-dropdown",6),O("ngModelChange",function(g){return S(i.selectedCampId,g)||(i.selectedCampId=g),g}),h("onChange",function(){return i.onCampChange()})("onClear",function(){return i.clearSelection()}),o(),_(8,Q,2,0,"small",7)(9,Y,2,1,"small",8),o()(),_(10,X,13,7,"div",9)(11,Z,3,0,"div",10)(12,ee,3,0,"div",10),o()()()),e&2&&(c(7),k("ngModel",i.selectedCampId),l("options",i.campOptions)("showClear",!0)("disabled",i.loading)("appendTo","body"),c(),l("ngIf",i.loading),c(),l("ngIf",i.errorMessage),c(),l("ngIf",i.selectedCampId&&i.filteredStockItems.length>0),c(),l("ngIf",!i.selectedCampId),c(),l("ngIf",i.selectedCampId&&i.filteredStockItems.length===0))},dependencies:[T,E,A,V,R,H,q,B,N,D,z,$,U,F],styles:[".current-stock-container[_ngcontent-%COMP%]{padding:0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px;padding:20px 0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;max-width:400px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:var(--medical-text);font-size:14px;margin-bottom:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{color:var(--medical-primary);font-size:12px;font-style:italic;margin-top:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{color:var(--medical-danger);font-size:12px;margin-top:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]     .p-dropdown{width:100%}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-bottom:15px;border-bottom:2px solid var(--medical-border)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:var(--medical-text);margin:0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px 16px;background:linear-gradient(135deg,#2c5aa01a,#2c5aa00d);border-radius:8px;border:1px solid var(--medical-primary)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:var(--medical-text);font-size:14px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:700;color:var(--medical-primary);font-size:18px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-thead>tr>th{background:linear-gradient(135deg,#f8f9fa,#e9ecef);color:var(--medical-text);font-weight:600;padding:12px;border-bottom:2px solid var(--medical-border);text-transform:uppercase;font-size:12px;letter-spacing:.5px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:12px;border-bottom:1px solid var(--medical-border)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .quantity-badge{display:inline-block;padding:4px 12px;background:linear-gradient(135deg,#2c5aa01a,#2c5aa00d);color:var(--medical-primary);border-radius:6px;font-weight:600;font-size:14px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:#f8f9fa}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:40px;text-align:center;background-color:#f8f9fa;border-radius:8px;color:var(--medical-text-light);margin-top:15px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}"]})};export{L as CurrentStockComponent};
