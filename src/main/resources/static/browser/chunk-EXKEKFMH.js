import{e as S}from"./chunk-3LQIMOVG.js";import{a as R}from"./chunk-Q4VZJRV6.js";import"./chunk-F72T5MOD.js";import"./chunk-4IR5X23O.js";import{a as A,b as L}from"./chunk-FOXQAKDV.js";import{g as q,h as z}from"./chunk-2AIVLR22.js";import{l as N,o as E,x as D}from"./chunk-E2RPOETZ.js";import"./chunk-E43D7RUH.js";import"./chunk-DZE63ZFE.js";import{a as w,b as T}from"./chunk-KBGVRL3M.js";import{Eb as l,Fb as d,Fd as y,Ia as c,Ib as M,Jb as h,Kb as b,Mb as P,Sa as k,T as C,Vd as v,Wd as I,Ya as m,db as s,m as g,mb as a,nb as i,rc as x,ub as _,vb as f,vc as O,y as u}from"./chunk-UXRMFRYK.js";var j=()=>[10,25,50];function B(o,n){o&1&&(a(0,"small",13),l(1,"Loading camps..."),i())}function V(o,n){if(o&1&&(a(0,"small",14),l(1),i()),o&2){let e=f();c(),d(e.errorMessage)}}function W(o,n){o&1&&(a(0,"tr")(1,"th"),l(2,"Medicine Name"),i(),a(3,"th"),l(4,"Medicine Type"),i(),a(5,"th"),l(6,"Quantity"),i()())}function Q(o,n){if(o&1&&(a(0,"tr")(1,"td"),l(2),i(),a(3,"td"),l(4),i(),a(5,"td")(6,"span",20),l(7),i()()()),o&2){let e=n.$implicit;c(2),d(e.medicine_name),c(2),d(e.medicine_type),c(3),d(e.quantity)}}function $(o,n){o&1&&(a(0,"tr")(1,"td",21),l(2,"No stock found for selected camp."),i()())}function H(o,n){if(o&1&&(a(0,"div",15)(1,"p-table",16),m(2,W,7,0,"ng-template",17)(3,Q,8,3,"ng-template",18)(4,$,3,0,"ng-template",19),i()()),o&2){let e=f();c(),s("value",e.filteredStockItems)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",P(5,j))}}function G(o,n){o&1&&(a(0,"div",22)(1,"p"),l(2,"Please select a camp from the dropdown to view its stock report."),i()())}function J(o,n){o&1&&(a(0,"div",22)(1,"p"),l(2,"No stock available for the selected camp."),i()())}var F=class o{campsService=C(R);router=C(S);camps=[];campOptions=[];selectedCampId=null;stockItems=[];filteredStockItems=[];loading=!1;errorMessage="";pageSize=1e3;pageNumber=0;pageSort="createdAt";ngOnInit(){this.loadCamps()}loadCamps(){this.loading=!0,this.errorMessage="";let n={status:"ACTIVE",page:this.pageNumber,size:this.pageSize,sort:this.pageSort};this.campsService.getActiveCamps(n).pipe(u(e=>(console.error("Error loading camps:",e),this.errorMessage="Failed to load camps. Please try again later.",this.loading=!1,g([])))).subscribe({next:e=>{let t=Array.isArray(e)?e:e.content??[];console.log("camps--->",t),this.camps=t,this.camps.length>0?(this.campOptions=this.camps.filter(r=>r.campId!==void 0).map(r=>({label:r.campCode?`${r.campCode} - ${r.campName}`:r.campName,value:r.campId})),this.loading=!1,this.loadSampleStockData()):(this.campOptions=[],this.loadSampleStockData(),this.errorMessage="No camps found. Please try again later.",this.loading=!1),console.log("campOptions--->",this.campOptions)},error:e=>{console.error("Error in camps subscription:",e),this.loading=!1}})}loadStockDataFromCamps(n){this.stockItems=[],n.forEach(e=>{e.medicineStocks&&e.medicineStocks.length>0&&e.medicineStocks.forEach(t=>{let r=`Medicine (HSN: ${t.hsnCode})`;this.stockItems.push({campId:e.campId,medicine_name:r,medicine_type:"N/A",quantity:t.quantity,batch_no:t.batchNumber,exp_date:t.expiryDate?new Date(t.expiryDate):void 0})})})}loadStockData(){}loadSampleStockData(){this.stockItems=[]}onCampChange(){this.selectedCampId?(this.loading=!0,this.errorMessage="",this.campsService.getCampMedicineStockSummary(this.selectedCampId).pipe(u(n=>(console.error("Error loading camp medicine stock summary:",n),this.errorMessage="Failed to load stock summary. Please try again later.",this.loading=!1,this.filteredStockItems=[],g([])))).subscribe({next:n=>{console.log("summary--->",n),this.filteredStockItems=n.map(e=>{let t=e.medicineStocks&&e.medicineStocks.length>0?e.medicineStocks[0]:e.medicineLookupNew?.medicineStocks&&e.medicineLookupNew.medicineStocks.length>0?e.medicineLookupNew.medicineStocks[0]:null;return{campId:this.selectedCampId,medicine_name:e.medicineLookupNew?.medicationName||"N/A",medicine_type:e.medicineLookupNew?.medicineType||"N/A",quantity:e.quantity,batch_no:t?.batchNumber,exp_date:t?.expiryDate?new Date(t.expiryDate):void 0}}),this.loading=!1},error:n=>{console.error("Error in camp medicine stock summary subscription:",n),this.loading=!1,this.filteredStockItems=[]}})):this.filteredStockItems=[]}clearSelection(){this.selectedCampId=null,this.filteredStockItems=[]}getTotalQuantity(){return this.filteredStockItems.reduce((n,e)=>n+e.quantity,0)}navigateToAddStock(){this.router.navigate(["/stock/add"])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=k({type:o,selectors:[["app-current-stock"]],decls:15,vars:11,consts:[[1,"current-stock-container"],["header","Stock Report"],[1,"stock-container"],[1,"selection-section"],[1,"field"],["for","camp"],["id","camp","optionLabel","label","optionValue","value","placeholder","Select Camp to View Stock Report",1,"w-full",3,"ngModelChange","onChange","onClear","ngModel","options","showClear","disabled","appendTo"],["class","loading-text",4,"ngIf"],["class","error-text",4,"ngIf"],[1,"add-stock-button-container"],["label","Add Stock","icon","pi pi-plus",3,"onClick","outlined"],["class","table-section",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"loading-text"],[1,"error-text"],[1,"table-section"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"quantity-badge"],["colspan","5",2,"text-align","center","padding","20px"],[1,"empty-state"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"p-card",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),l(6,"Select Camp"),i(),a(7,"p-dropdown",6),b("ngModelChange",function(p){return h(t.selectedCampId,p)||(t.selectedCampId=p),p}),_("onChange",function(){return t.onCampChange()})("onClear",function(){return t.clearSelection()}),i(),m(8,B,2,0,"small",7)(9,V,2,1,"small",8),i(),a(10,"div",9)(11,"p-button",10),_("onClick",function(){return t.navigateToAddStock()}),i()()(),m(12,H,5,6,"div",11)(13,G,3,0,"div",12)(14,J,3,0,"div",12),i()()()),e&2&&(c(7),M("ngModel",t.selectedCampId),s("options",t.campOptions)("showClear",!0)("disabled",t.loading)("appendTo","body"),c(),s("ngIf",t.loading),c(),s("ngIf",t.errorMessage),c(2),s("outlined",!0),c(),s("ngIf",t.selectedCampId&&t.filteredStockItems.length>0),c(),s("ngIf",!t.selectedCampId),c(),s("ngIf",t.selectedCampId&&t.filteredStockItems.length===0))},dependencies:[O,x,D,N,E,T,w,y,I,v,L,A,z,q],styles:[".current-stock-container[_ngcontent-%COMP%]{padding:0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px;padding:20px 0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-end;gap:20px;flex-wrap:wrap}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .add-stock-button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-left:auto}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;max-width:400px;flex:0 0 auto}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:var(--medical-text);font-size:14px;margin-bottom:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{color:var(--medical-primary);font-size:12px;font-style:italic;margin-top:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{color:var(--medical-danger);font-size:12px;margin-top:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]     .p-dropdown{width:100%}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;padding-bottom:15px;border-bottom:2px solid var(--medical-border)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:var(--medical-text);margin:0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px 16px;background:linear-gradient(135deg,#2c5aa01a,#2c5aa00d);border-radius:8px;border:1px solid var(--medical-primary)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:var(--medical-text);font-size:14px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:700;color:var(--medical-primary);font-size:18px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-thead>tr>th{background:linear-gradient(135deg,#f8f9fa,#e9ecef);color:var(--medical-text);font-weight:600;padding:12px;border-bottom:2px solid var(--medical-border);text-transform:uppercase;font-size:12px;letter-spacing:.5px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:12px;border-bottom:1px solid var(--medical-border)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .quantity-badge{display:inline-block;padding:4px 12px;background:linear-gradient(135deg,#2c5aa01a,#2c5aa00d);color:var(--medical-primary);border-radius:6px;font-weight:600;font-size:14px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:#f8f9fa}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:40px;text-align:center;background-color:#f8f9fa;border-radius:8px;color:var(--medical-text-light);margin-top:15px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}"]})};export{F as CurrentStockComponent};
