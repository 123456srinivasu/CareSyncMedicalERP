import{e as S}from"./chunk-NKJII4UE.js";import{c as R}from"./chunk-NMLCC23A.js";import"./chunk-IJJPJVDK.js";import{a as L,b as A}from"./chunk-D5EJ5CD3.js";import{g as q,h as z}from"./chunk-LEPUTGTX.js";import{l as E,m as N,t as D}from"./chunk-W2D7UK2I.js";import"./chunk-WRQEY5KG.js";import"./chunk-AEOE4SX4.js";import{a as w,b as T}from"./chunk-PNZADVY2.js";import{Dd as y,Eb as c,Fb as d,Ia as r,Ib as M,Jb as h,Kb as P,Mb as x,Sa as k,Sd as v,T as u,Td as I,Ya as m,db as l,m as g,mb as a,nb as i,rc as b,ub as _,vb as f,vc as O,y as C}from"./chunk-KIZY3JWN.js";var j=()=>[10,25,50];function B(o,t){o&1&&(a(0,"small",13),c(1,"Loading camps..."),i())}function W(o,t){if(o&1&&(a(0,"small",14),c(1),i()),o&2){let e=f();r(),d(e.errorMessage)}}function Q(o,t){o&1&&(a(0,"tr")(1,"th"),c(2,"Medicine Name"),i(),a(3,"th"),c(4,"Medicine Type"),i(),a(5,"th"),c(6,"Quantity"),i()())}function V(o,t){if(o&1&&(a(0,"tr")(1,"td"),c(2),i(),a(3,"td"),c(4),i(),a(5,"td")(6,"span",20),c(7),i()()()),o&2){let e=t.$implicit;r(2),d(e.medicine_name),r(2),d(e.medicine_type),r(3),d(e.quantity)}}function $(o,t){o&1&&(a(0,"tr")(1,"td",21),c(2,"No stock found for selected camp."),i()())}function H(o,t){if(o&1&&(a(0,"div",15)(1,"p-table",16),m(2,Q,7,0,"ng-template",17)(3,V,8,3,"ng-template",18)(4,$,3,0,"ng-template",19),i()()),o&2){let e=f();r(),l("value",e.filteredStockItems)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",x(5,j))}}function G(o,t){o&1&&(a(0,"div",22)(1,"p"),c(2,"Please select a camp from the dropdown to view its stock report."),i()())}function J(o,t){o&1&&(a(0,"div",22)(1,"p"),c(2,"No stock available for the selected camp."),i()())}var F=class o{campsService=u(R);router=u(S);camps=[];campOptions=[];selectedCampId=null;stockItems=[];filteredStockItems=[];loading=!1;errorMessage="";ngOnInit(){this.loadCamps()}loadCamps(){this.loading=!0,this.errorMessage="",this.campsService.getActiveCamps().pipe(C(t=>(console.error("Error loading camps:",t),this.errorMessage="Failed to load camps. Please try again later.",this.loading=!1,g([])))).subscribe({next:t=>{this.camps=t,this.camps.length>0?(this.campOptions=this.camps.filter(e=>e.campId!==void 0).map(e=>({label:e.campCode?`${e.campCode} - ${e.campName}`:e.campName,value:e.campId})),this.loading=!1,this.loadSampleStockData()):(this.campOptions=[],this.loadSampleStockData(),this.errorMessage="No camps found. Please try again later.",this.loading=!1),console.log("campOptions--->",this.campOptions)},error:t=>{console.error("Error in camps subscription:",t),this.loading=!1}})}loadStockDataFromCamps(t){this.stockItems=[],t.forEach(e=>{e.medicineStocks&&e.medicineStocks.length>0&&e.medicineStocks.forEach(n=>{let s=`Medicine (HSN: ${n.hsnCode})`;this.stockItems.push({campId:e.campId,medicine_name:s,medicine_type:"N/A",quantity:n.quantity,batch_no:n.batchNumber,exp_date:n.expiryDate?new Date(n.expiryDate):void 0})})})}loadStockData(){}loadSampleStockData(){this.stockItems=[]}onCampChange(){this.selectedCampId?(this.loading=!0,this.errorMessage="",this.campsService.getCampMedicineStockSummary(this.selectedCampId).pipe(C(t=>(console.error("Error loading camp medicine stock summary:",t),this.errorMessage="Failed to load stock summary. Please try again later.",this.loading=!1,this.filteredStockItems=[],g([])))).subscribe({next:t=>{console.log("summary--->",t),this.filteredStockItems=t.map(e=>{let n=e.medicineStocks&&e.medicineStocks.length>0?e.medicineStocks[0]:e.medicineLookupNew?.medicineStocks&&e.medicineLookupNew.medicineStocks.length>0?e.medicineLookupNew.medicineStocks[0]:null;return{campId:this.selectedCampId,medicine_name:e.medicineLookupNew?.medicationName||"N/A",medicine_type:e.medicineLookupNew?.medicineType||"N/A",quantity:e.quantity,batch_no:n?.batchNumber,exp_date:n?.expiryDate?new Date(n.expiryDate):void 0}}),this.loading=!1},error:t=>{console.error("Error in camp medicine stock summary subscription:",t),this.loading=!1,this.filteredStockItems=[]}})):this.filteredStockItems=[]}clearSelection(){this.selectedCampId=null,this.filteredStockItems=[]}getTotalQuantity(){return this.filteredStockItems.reduce((t,e)=>t+e.quantity,0)}navigateToAddStock(){this.router.navigate(["/stock/add"])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=k({type:o,selectors:[["app-current-stock"]],decls:15,vars:11,consts:[[1,"current-stock-container"],["header","Stock Report"],[1,"stock-container"],[1,"selection-section"],[1,"field"],["for","camp"],["id","camp","optionLabel","label","optionValue","value","placeholder","Select Camp to View Stock Report",1,"w-full",3,"ngModelChange","onChange","onClear","ngModel","options","showClear","disabled","appendTo"],["class","loading-text",4,"ngIf"],["class","error-text",4,"ngIf"],[1,"add-stock-button-container"],["label","Add Stock","icon","pi pi-plus",3,"onClick","outlined"],["class","table-section",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"loading-text"],[1,"error-text"],[1,"table-section"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"quantity-badge"],["colspan","5",2,"text-align","center","padding","20px"],[1,"empty-state"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"p-card",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),c(6,"Select Camp"),i(),a(7,"p-dropdown",6),P("ngModelChange",function(p){return h(n.selectedCampId,p)||(n.selectedCampId=p),p}),_("onChange",function(){return n.onCampChange()})("onClear",function(){return n.clearSelection()}),i(),m(8,B,2,0,"small",7)(9,W,2,1,"small",8),i(),a(10,"div",9)(11,"p-button",10),_("onClick",function(){return n.navigateToAddStock()}),i()()(),m(12,H,5,6,"div",11)(13,G,3,0,"div",12)(14,J,3,0,"div",12),i()()()),e&2&&(r(7),M("ngModel",n.selectedCampId),l("options",n.campOptions)("showClear",!0)("disabled",n.loading)("appendTo","body"),r(),l("ngIf",n.loading),r(),l("ngIf",n.errorMessage),r(2),l("outlined",!0),r(),l("ngIf",n.selectedCampId&&n.filteredStockItems.length>0),r(),l("ngIf",!n.selectedCampId),r(),l("ngIf",n.selectedCampId&&n.filteredStockItems.length===0))},dependencies:[O,b,D,E,N,T,w,y,I,v,A,L,z,q],styles:[".current-stock-container[_ngcontent-%COMP%]{padding:0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px;padding:20px 0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-end;gap:20px;flex-wrap:wrap}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .add-stock-button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-left:auto}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;max-width:400px;flex:0 0 auto}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:var(--medical-text);font-size:14px;margin-bottom:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{color:var(--medical-primary);font-size:12px;font-style:italic;margin-top:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{color:var(--medical-danger);font-size:12px;margin-top:4px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]     .p-dropdown{width:100%}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;padding-bottom:15px;border-bottom:2px solid var(--medical-border)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:var(--medical-text);margin:0}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px 16px;background:linear-gradient(135deg,#2c5aa01a,#2c5aa00d);border-radius:8px;border:1px solid var(--medical-primary)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:var(--medical-text);font-size:14px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .total-quantity[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:700;color:var(--medical-primary);font-size:18px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-thead>tr>th{background:linear-gradient(135deg,#f8f9fa,#e9ecef);color:var(--medical-text);font-weight:600;padding:12px;border-bottom:2px solid var(--medical-border);text-transform:uppercase;font-size:12px;letter-spacing:.5px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:12px;border-bottom:1px solid var(--medical-border)}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td .quantity-badge{display:inline-block;padding:4px 12px;background:linear-gradient(135deg,#2c5aa01a,#2c5aa00d);color:var(--medical-primary);border-radius:6px;font-weight:600;font-size:14px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:#f8f9fa}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:40px;text-align:center;background-color:#f8f9fa;border-radius:8px;color:var(--medical-text-light);margin-top:15px}.current-stock-container[_ngcontent-%COMP%]   .stock-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}"]})};export{F as CurrentStockComponent};
